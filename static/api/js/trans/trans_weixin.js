window._bd_share_main.F.module("trans/trans_weixin",function(n,i){var a,r,d,e="bdshare_weixin_qrcode_dialog",t="",c=0,p={},s=n("base/tangram").T,u=(n("conf/const").URLS,function(n){var e=Math.round(200/n.length),o=['<table style="direction:ltr;border: 0; width:'+(c=(e=e<2?2:e)*n.length)+'px; border-collapse: collapse;background-color:#fff;margin:0 auto;" align="center">'],d="";return s.each(n,function(n,i){o.push("<tr>"),s.each(i,function(n,i){d='<td style="width:'+e+"px;height:"+e+"px;padding:0;margin:0;border:none;background:#"+(i?"000":"FFF")+'"></td>',o.push(d)})}),o.push("</table>"),o.join("")}),o=function(){var o;a.attr("data-url")!=t&&(d.html("正在加载"),t.length,o=t,window._bd_share_main.F.use("component/qrcode",function(n){var i=new n.QRCode(-1,n.QRErrorCorrectLevel.L);i.addData(o),i.make();var e=u(i.modules);s(e).appendTo(d.empty()),_(c),h(),a.attr("data-url",o)}))},_=function(n){var i=(220<n?n:220)+20,e=s(".bd_weixin_popup_foot").height()+s(".bd_weixin_popup_head").height()+n+30;a.css({width:i,height:e})},f=function(){a.find(".bd_weixin_popup_close").click(w),s("body").on("keydown",function(n){27==n.keyCode&&w()}),s(window).resize(function(){h()})},h=function(){var n=s(window).scrollTop(),i=a.outerWidth(),e=a.outerHeight(),o=s(window).width(),d=(s(window).height()-e)/2+n,t=(o-i)/2;d=d<0?0:d,t=t<0?0:t,r.width(i).height(e).css({left:t,top:d}),a.css({left:t,top:d})},l=function(){a.show(),r.show(),h()},w=function(){a.hide(),r.hide()},b=function(n){n=function(n){var i="10006-weixin-1-52626-6b3bffd01fdde4900130bc5a2751b6d1";if("off"===p.sign)return n;if("normal"!==p.sign)return n.replace(/#.*$/g,"")+"#"+i;var e=n.indexOf("#"),o=n.indexOf("?");return-1==e?n+(-1==o?"?":"&")+i:n.replace("#",(-1==o?"?":"&")+i+"#")}(n);var e=[];return s.each(n,function(n,i){/[^\x00-\xff]/.test(i)?e[n]=encodeURI(i):e[n]=i}),e.join("")};i.run=function(n){t=b((p=n).url),window._bd_share_main.F.use("weixin_popup.css",function(){window._bd_share_main.F.use("component/pop_dialog",function(n){n.Dialog.hide()}),function(){if(a=s("#"+e),r=s("#"+e+"_bg"),a.length<1){var n=['<div id="'+e+'" class="bd_weixin_popup">','<div class="bd_weixin_popup_head">',"<span>分享到微信朋友圈</span>",'<a href="#" onclick="return false;" class="bd_weixin_popup_close">&times;</a>',"</div>",'<div id="'+e+'_qr" class="bd_weixin_popup_main"></div>','<div class="bd_weixin_popup_foot">打开微信，点击底部的“发现”，<br>使用“扫一扫”即可将网页分享至朋友圈。</div>',"</div>"].join("");r=s('<iframe id="bdshare_weixin_qrcode_dialog_bg" class="bd_weixin_popup_bg"></iframe>').appendTo("body"),a=s(n).appendTo("body"),f()}d=a.find("#"+e+"_qr"),l()}(),o()})}});